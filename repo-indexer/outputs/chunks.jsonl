{"id": "sha1:d153647678bba44e89c974b67d1cee57530e1fd2", "filepath": "controller\\staticrouter.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 23, "text": "const mongoose = require('mongoose')\nconst Url=require('../model/url')\nconst user=require('../model/urluser')\nasync function home(req,res) {\n   try {\n    if(!req.user)return req.redirect('/login')\n    const urls = await Url.find({createdby:req.user._id});\n    return res.status(200).render('home', { urls });\n  } catch (err) {\n    console.error(err);\n    return res.status(500).send('Server Error');\n  }\n}\n\n\n\nasync function signup(req,res) {\n res.status(200).render('signup')\n}\nasync function login(req,res){\n  res.status(200).render('login')\n}\nmodule.exports={home,signup,login}", "summary": "Block: const mongoose = require('mongoose')...", "tokens_estimate": 144, "parents": [], "imports": [], "examples": [], "code_fingerprint": "d153647678bba44e89c974b67d1cee57530e1fd2", "last_modified": "2025-07-29T15:13:44.307971", "parser_fallback": true}
{"id": "sha1:290e3e654b2911d42eed40730e5dfa78f8b57efe", "filepath": "controller\\url.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 31, "text": "const mongoose = require('mongoose')\nconst Url=require('../model/url')\nconst short=require('shortid')\n\nasync function generateonsubmit(req,res){\n  const shortid=short.generate()\n\n  if(!req.body.url) return res.status(400).json({msg:'url required'})\n  const url=await Url.create({\n      shorturl:shortid,\n      redirect:req.body.url,\n      createdby:req.user._id\n  })\n   const urls = await Url.find({createdby:req.user._id});\n  return res.status(200).render('home',{\n    urls\n  })\n}\n\nasync function redirectonsubmit(req,res){\n  const shortid=req.params.shortid\n  const redirect = await Url.findOneAndUpdate({shorturl: shortid},\n    { new: true } \n  );\n  if (!redirect) {\n    return res.status(404).json({ msg: 'Short URL not found' });\n  }\n  return res.redirect(redirect.redirect);\n}\n\nmodule.exports={generateonsubmit,redirectonsubmit}", "summary": "Block: const mongoose = require('mongoose')...", "tokens_estimate": 208, "parents": [], "imports": [], "examples": [], "code_fingerprint": "290e3e654b2911d42eed40730e5dfa78f8b57efe", "last_modified": "2025-07-29T15:16:29.166731", "parser_fallback": true}
{"id": "sha1:52237c56f943c36ef8910a859712208358198607", "filepath": "controller\\user.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 34, "text": "const mongoose = require('mongoose')\nconst {setUser}=require('../service/auth')\n\nconst user=require('../model/urluser')\nasync function usersignup(req,res) {\n    try{\n      const { name, email, password }=req.body;\nif (!name || !email || !password) {\n      return res.status(400).send(\"All fields are required\");\n    }\n    await user.create(\n        {name,email,password}\n    );\n    \n    return res.redirect('/login');\n  } catch (e) {\n    console.error(e);\n    return res.status(500).send(\"Server Error\");\n  }\n}\nasync function userlogin(req,res) {\n  const {email,password}=req.body;\n  const users = await user.findOne({email,password})\n  if(!users)\n  {\n    res.status(404).redirect(\"/login\");\n\n  }else{\n    const token=setUser(users)\n    res.cookie('uid',token)\n    res.status(200).redirect('/')\n  }\n}\nmodule.exports={usersignup,userlogin}", "summary": "Block: const mongoose = require('mongoose')...", "tokens_estimate": 209, "parents": [], "imports": [], "examples": [], "code_fingerprint": "52237c56f943c36ef8910a859712208358198607", "last_modified": "2025-07-29T15:21:24.337880", "parser_fallback": true}
{"id": "sha1:36ad951c2dd05c6b990c1b1ddde04487345f64d6", "filepath": "middleware\\auth.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 23, "text": "const {getuser}=require('../service/auth')\n\nasync function restrictologuser(req,res,next)\n{\n const uid=req.cookies.uid;\n if(!uid)\n {\n    return res.redirect('/login')\n }\n const user=getuser(uid)\n if(!user) return res.redirect('/login');\n req.user=user;\n next()\n}\nasync function checkauth(req,res,next)\n{\n const uid=req.cookies?.uid;\n const user=getuser(uid)\n \n req.user=user;\n next()\n}\nmodule.exports={restrictologuser,checkauth};", "summary": "Block: const {getuser}=require('../service/auth')...", "tokens_estimate": 107, "parents": [], "imports": [], "examples": [], "code_fingerprint": "36ad951c2dd05c6b990c1b1ddde04487345f64d6", "last_modified": "2025-07-29T14:58:07.718867", "parser_fallback": true}
{"id": "sha1:e687cc64cce413ee26de9706fcc4eccce7d35730", "filepath": "model\\url.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 19, "text": "const mongoose=require('mongoose')\nconst urlschema=mongoose.Schema({\n    shorturl:{\n        type:String,\n        required:true,\n        unique:true\n    },\n    redirect:{\n        type:String,\n        required:true\n    },\n    createdby:\n    {\n        type:mongoose.Schema.Types.ObjectId,\n        ref:\"urluser\"\n    }\n})\nconst url=mongoose.model(\"url\",urlschema)\nmodule.exports=url;", "summary": "Block: const mongoose=require('mongoose')...", "tokens_estimate": 94, "parents": [], "imports": [], "examples": [], "code_fingerprint": "e687cc64cce413ee26de9706fcc4eccce7d35730", "last_modified": "2025-07-29T14:23:07.535517", "parser_fallback": true}
{"id": "sha1:2f120ad047489b6557cc1fec787342b3bc603e91", "filepath": "model\\urluser.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 21, "text": "const mongoose=require('mongoose')\nconst urluserschema=mongoose.Schema({\n    name:{\n        type:String,\n        required:true,\n        \n    },\n    email:{\n        type:String,\n        required:true,\n        unique:true,\n        lowercase:true,\n    },\n   password:{type:String,\n    required:true,\n    minlength:4,\n}\n}\n)\nconst urluser=mongoose.model(\"urluser\",urluserschema)\nmodule.exports=urluser;", "summary": "Block: const mongoose=require('mongoose')...", "tokens_estimate": 99, "parents": [], "imports": [], "examples": [], "code_fingerprint": "2f120ad047489b6557cc1fec787342b3bc603e91", "last_modified": "2025-07-26T21:06:25.526720", "parser_fallback": true}
{"id": "sha1:2998516d3614efcb90d7ad0842fe49579fdc762c", "filepath": "route\\staticrouter.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 8, "text": "const express=require('express')\nconst router=express.Router()\nconst {home,signup,login}=require('../controller/staticrouter')\nconst {restrictologuser}=require('../middleware/auth')\nrouter.route(\"/\").get(restrictologuser,home)\nrouter.route(\"/signup\").get(signup)\nrouter.route(\"/login\").get(login)\nmodule.exports=router;", "summary": "Block: const express=require('express')...", "tokens_estimate": 79, "parents": [], "imports": [], "examples": [], "code_fingerprint": "2998516d3614efcb90d7ad0842fe49579fdc762c", "last_modified": "2025-07-27T12:15:46.365762", "parser_fallback": true}
{"id": "sha1:15b2a653f5f9d10f4d86a77b065569e6feee387f", "filepath": "route\\url.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 10, "text": "\nconst express = require('express')\nconst {generateonsubmit,redirectonsubmit}=require('../controller/url')\nconst router=express.Router()\nrouter.route('/')\n.post(generateonsubmit)\nrouter.route('/:shortid')\n.get(redirectonsubmit)\n\nmodule.exports = router;", "summary": "Block: const express = require('express')...", "tokens_estimate": 63, "parents": [], "imports": [], "examples": [], "code_fingerprint": "15b2a653f5f9d10f4d86a77b065569e6feee387f", "last_modified": "2025-07-26T21:07:17.533614", "parser_fallback": true}
{"id": "sha1:1d94b251529bdafcb9f9eb51cb17bd3cb67ef3ec", "filepath": "route\\user.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 7, "text": "\nconst express = require('express')\nconst router=express.Router()\nconst {usersignup,userlogin}=require('../controller/user')\nrouter.route('/').post(usersignup)\nrouter.post('/login',userlogin)\nmodule.exports=router;", "summary": "Block: const express = require('express')...", "tokens_estimate": 53, "parents": [], "imports": [], "examples": [], "code_fingerprint": "1d94b251529bdafcb9f9eb51cb17bd3cb67ef3ec", "last_modified": "2025-07-27T11:28:22.810393", "parser_fallback": true}
{"id": "sha1:faea793392a02677f0b173355997c12d6698d879", "filepath": "service\\auth.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 15, "text": "const { render } = require('ejs');\nconst jwt=require('jsonwebtoken');\nconst secret='harsh@24bhi'\nfunction setUser(user){\n   const payload={\n     _id:user._id,\n     email:user.email\n   };\n   return jwt.sign(payload,secret);\n}\nfunction getuser(token){\n    if(!token)return \n    return jwt.verify(token,secret)\n}\nmodule.exports={setUser,getuser}", "summary": "Block: const { render } = require('ejs');...", "tokens_estimate": 85, "parents": [], "imports": [], "examples": [], "code_fingerprint": "faea793392a02677f0b173355997c12d6698d879", "last_modified": "2025-07-29T14:51:59.801216", "parser_fallback": true}
{"id": "sha1:d248f687aca0815cec9fd6292bebdb43da2db483", "filepath": "views\\home.ejs", "language": "unknown", "node_type": "block", "start_line": 1, "end_line": 40, "text": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Document</title>\n</head>\n<body>\n    <h1>Url Shortner</h1>\n    <div>\n    <form action=\"/url\" method=\"POST\" >\n        <label for=\"urlinput\">Enter the Url</label>\n        <input type=\"text\" name=\"url\" id=\"urlinput\" placeholder=\"https://exapmle.com\" >\n        <button type=\"submit\">Generate</button>\n    </form>\n    </div>\n    <div>\n        <%  if (urls) { %>\n             <table border=\"1\">\n                <thead>\n                    <th>Sl.No</th>\n                    <th>ShortId</th>\n                    <th>RedirectId</th>\n                   \n                </thead>\n                <tbody>\n                    <% urls.forEach((url,index) => { %>\n                     <tr>\n                        <td><%= index+1  %></td>\n                        <td>localhost:3000/url/<%= url.shorturl %></td>\n                        <td><%= url.redirect %></td>\n                     </tr>\n                    <% }) %>\n                </tbody>\n             </table>\n            <% } %>\n         \n    </div>\n</body>\n</html>", "summary": "Block: <!DOCTYPE html>...", "tokens_estimate": 290, "parents": [], "imports": [], "examples": [], "code_fingerprint": "d248f687aca0815cec9fd6292bebdb43da2db483", "last_modified": "2025-07-29T14:35:55.297524", "parser_fallback": true}
{"id": "sha1:f2c5778ffefd2b1d0c29e6aa2148fe65c2693cdd", "filepath": "views\\login.ejs", "language": "unknown", "node_type": "block", "start_line": 1, "end_line": 20, "text": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Document</title>\n</head>\n<body>\n    <h1>Login</h1>\n    <div>\n        <form action=\"/user/login\" method=\"post\">\n            <label for=\"email\">Email</label>\n            <input type=\"text\" id=\"email\" name=\"email\">\n            <label for=\"password\">password</label>\n            <input type=\"password\" id=\"password\" name=\"password\">\n            <button type=\"submit\">Login</button>\n        </form>\n    </div>\n</body>\n</html>", "summary": "Block: <!DOCTYPE html>...", "tokens_estimate": 143, "parents": [], "imports": [], "examples": [], "code_fingerprint": "f2c5778ffefd2b1d0c29e6aa2148fe65c2693cdd", "last_modified": "2025-07-27T11:29:16.040437", "parser_fallback": true}
{"id": "sha1:84543032dc3b773b36884c6044de5765d0fa78f6", "filepath": "views\\signup.ejs", "language": "unknown", "node_type": "block", "start_line": 1, "end_line": 21, "text": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Document</title>\n</head>\n<body>\n    <div>\n    <form method=\"POST\" action=\"/user\">\n       <label for=\"name\">Name</label>\n       <input type=\"text\" name=\"name\" id=\"name\">\n       <label for=\"email\">email</label>\n       <input type=\"text\" name=\"email\" id=\"email\" placeholder=\"exapmle@gmail.com\">\n       <label for=\"pass\">Password</label>\n       <input type=\"text\" name=\"password\" id=\"pass\" placeholder=\"should be of min 4 char\">\n       <button type=\"submit\">create</button>\n    </form>\n    </div>\n</body>\n</html>", "summary": "Block: <!DOCTYPE html>...", "tokens_estimate": 165, "parents": [], "imports": [], "examples": [], "code_fingerprint": "84543032dc3b773b36884c6044de5765d0fa78f6", "last_modified": "2025-07-26T21:56:48.171067", "parser_fallback": true}
{"id": "sha1:52d7c531ea1047813d4ff6d8c6cfc58f6a53a0ce", "filepath": "index.js", "language": "javascript", "node_type": "block", "start_line": 1, "end_line": 23, "text": "const express = require('express')\nconst path= require('path')\nconst  mongoose = require('mongoose')\nconst ejs=require('ejs')\nconst routeurl=require('./route/url')\nconst app = express()\nconst port = 3000\nconst userroute=require('./route/user')\nconst {restrictologuser,checkauth}=require('./middleware/auth')\nconst staticroute=require ('./route/staticrouter')\nconst cookieParser = require('cookie-parser');\napp.set(\"view engine\",\"ejs\")\napp.set('views',path.resolve(\"./views\"))\n\nmongoose.connect(\"mongodb://127.0.0.1:27017/url\").then(()=>console.log('mongo connected'))\n.catch((e)=>console.log('mongoeror',e))\napp.use(express.json())\napp.use(cookieParser())\napp.use(express.urlencoded({extended:false}))\napp.use('/url',restrictologuser,routeurl)\napp.use('/',checkauth,staticroute)\napp.use('/user',userroute)\napp.listen(port, () => console.log(`started at ${port}!`))", "summary": "Block: const express = require('express')...", "tokens_estimate": 216, "parents": [], "imports": [], "examples": [], "code_fingerprint": "52d7c531ea1047813d4ff6d8c6cfc58f6a53a0ce", "last_modified": "2025-07-28T15:33:35.849796", "parser_fallback": true}
{"id": "sha1:64ef36a5b4f7f6ce32fca7209e5c6870f0234818", "filepath": "package.json", "language": "unknown", "node_type": "block", "start_line": 1, "end_line": 22, "text": "{\n  \"name\": \"urlshortener\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"license\": \"ISC\",\n  \"author\": \"\",\n  \"type\": \"commonjs\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n  },\n  \"dependencies\": {\n    \"cookie-parser\": \"^1.4.7\",\n    \"ejs\": \"^3.1.10\",\n    \"express\": \"^5.1.0\",\n    \"jsonwebtoken\": \"^9.0.2\",\n    \"mongoose\": \"^8.16.4\",\n    \"shortid\": \"^2.2.17\",\n    \"uuid\": \"^11.1.0\"\n  }\n}\n", "summary": "Block: {...", "tokens_estimate": 109, "parents": [], "imports": [], "examples": [], "code_fingerprint": "64ef36a5b4f7f6ce32fca7209e5c6870f0234818", "last_modified": "2025-07-29T14:39:39.601352", "parser_fallback": true}
